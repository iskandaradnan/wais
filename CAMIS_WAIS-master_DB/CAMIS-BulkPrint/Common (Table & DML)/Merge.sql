MERGE INTO dbo.EngPlannerTxndet WITH (HOLDLOCK) AS targetUSING dbo.EngPlannerTxn AS source    ON target.plannerid = source.plannerid    WHEN MATCHED THEN     UPDATE SET target.Plannerdate = source.firstdateWHEN NOT MATCHED BY TARGET THEN    	INSERT             ([PlannerId]           ,[CustomerId]           ,[FacilityId]           ,[ScheduleType]           ,[Year]           ,[Month]           ,[Date]           ,[Week]           ,[Day]           ,[PlannerDate]           ,[CreatedBy]           ,[CreatedDate]           ,[CreatedDateUTC]           ,[ModifiedBy]           ,[ModifiedDate]           ,[ModifiedDateUTC]           ,[GuId]           --,[OLD_PlannerDate]		   )     VALUES           (		 source.plannerid,         source.CustomerId,          source.FacilityId,          source.ScheduleType,          source.[Year],          source.Month,         source.Date,         source.Week,         source.Day,          source.Firstdate,         source.CreatedBy,          source.CreatedDate,          source.CreatedDateUTC,         source.ModifiedBy,          source.ModifiedDate,          source.ModifiedDateUTC,         source.[GuId]         --,source.Firstdate		 )		WHEN NOT MATCHED BY SOURCE THEN    DELETE ;	       